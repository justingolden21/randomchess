<!DOCTYPE html>
<html lang="en">
<head>
	<!-- TODO
update with font awesome icons downloaded from website
add title and options: move length, infinite repeat or no?
repeat for x moves, x time, or x games
multiple games going at once?
edit css
	 -->

<title>Random Chess</title>
<meta charset="utf-8">
<meta name="title=" content="Random Chess">
<meta name="robots" content="index, follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Watch random games of chess. Pass the time or a fun screensaver.">
<meta name="keywords" content="random chess, chess, random, screensaver, wallpaper, background, random game">

<link rel="icon" href="img/chesspieces/wikipedia/bK.png" type="image/png">

<meta id="theme1" name="theme-color" content="#fff">
<meta id="theme2" name="msapplication-navbutton-color" content="#fff">
<meta id="theme3" name="apple-mobile-web-app-status-bar-style" content="#fff">

<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css" integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous"> -->

<script src="chessjs/chess.min.js"></script>
<script src="chessboardjs/js/chessboard-0.3.0.min.js"></script>
<link rel="stylesheet" href="chessboardjs/css/chessboard-0.3.0.min.css">

<h3>Random Chess</h3>

<div id="board" style="width: 400px"></div>
Moves this game: <span id="numMovesCurrent">0</span>

<h3>Settings</h3>

<input id="repeat" checked type="checkbox">
<label for="repeat">Start a new game after previous one finishes</label>
<br>

<input id="moveLen" type="range" min="25" max="2000" value="500" step="25">
Move Length: <span id="moveLenDisplay">500</span>ms

<h3>Stats</h3>
Games Won/Lost: <span id="numWin">0</span>
<br>
Games Drawn: <span id="numDraw">0</span>
<br>
Total Moves: <span id="numMovesTotal">0</span>

<script>
	let board, game;
var init = function() {

//--- start example JS ---
  game = new Chess();

var makeRandomMove = function() {
  var possibleMoves = game.moves();

  $('#numMovesCurrent').html(parseInt($('#numMovesCurrent').html() )+1);

  // exit if the game is over
  if (game.game_over() || game.in_draw() || possibleMoves.length === 0) { 

  	//track game
  	addGame(game.in_draw(), game.history().length);

  	//make new game
  	if($('#repeat').is(':checked') ) {
      $('#numMovesCurrent').html(0);
  		game = new Chess();
  		board = ChessBoard('board', 'start');
  		window.setTimeout(makeRandomMove, $('#moveLen').val() );
  	}

    return;
  }

  var randomIndex = Math.floor(Math.random() * possibleMoves.length);
  game.move(possibleMoves[randomIndex]);
  board.position(game.fen());

  window.setTimeout(makeRandomMove, $('#moveLen').val() );
};

board = ChessBoard('board', 'start');

window.setTimeout(makeRandomMove, 50);


$('#moveLen').on('change', function() {
	$('#moveLenDisplay').html($(this).val() );
})

//--- end example JS ---

}; // end init()
$(document).ready(init);

function addGame(draw, numMoves) {
	if(draw) {
		$('#numDraw').html(parseInt($('#numDraw').html() )+1);
	} else {
		$('#numWin').html(parseInt($('#numWin').html() )+1);
	}
  $('#numMovesTotal').html(parseInt($('#numMovesTotal').html() )+numMoves);
  console.log('Draw? ' + draw + ' Moves: ' + numMoves);
}


</script>
</body>
</html>